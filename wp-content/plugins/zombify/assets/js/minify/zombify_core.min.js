Array.prototype.contains=function(e){for(var i=this.length;i--;)if(this[i]===e)return!0;return!1};var isSafari11=!1;navigator.browserSpecs=function(){var e,i=navigator.userAgent,r=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?(e=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:e[1]||""}):"Chrome"===r[1]&&(e=i.match(/\b(OPR|Edge)\/(\d+)/),null!=e)?{name:e[1].replace("OPR","Opera"),version:e[2]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=i.match(/version\/(\d+)/i))&&r.splice(1,1,e[1]),{name:r[0],version:r[1]})}(),"safari"==navigator.browserSpecs.name.toLowerCase()&&navigator.browserSpecs.version>=11&&navigator.browserSpecs.version<11.5&&(isSafari11=!0);var ZombifyBuilder=new function(){this.saving_post=!1,this.saving_virtual_post=!1,this.trigger_post_save=!1,this.input_focus=!1,this.trigger_post_save_data={},this.addGroup=function(e){if(quiz_type=e.closest("form").find(".zombify_quiz_type").val(),group_name=e.data("zombify-group"),1==e.attr("data-zombify-inside"))var i=e.closest(".zombify_group").parent().closest(".zombify_group");else var i=e.closest(".zombify_group");if(i.length>0)var r=i;else var r=e.closest(".zombify_quiz");var t=r.find(".zf-"+group_name+"-container").data("reverse");r.find(".zombify_group[data-zombify-group-name='"+group_name+"']").eq(0).find(".zf-wysiwyg-advanced").each(function(){0===jQuery(this).parents(".zf-erase-before-save").length&&jQuery(this).froalaEditor("destroy")}),r.find(".zombify_group[data-zombify-group-name='"+group_name+"']").eq(0).find(".zf-wysiwyg-light").each(function(){0===jQuery(this).parents(".zf-erase-before-save").length&&jQuery(this).froalaEditor("destroy")}),r.find(".zombify_group[data-zombify-group-name='"+group_name+"']").eq(0).find(".zf-result-wysiwyg-light.active").each(function(){0===jQuery(this).parents(".zf-erase-before-save").length&&jQuery(this).froalaEditor("destroy")});var a=r.find(".zombify_group[data-zombify-group-name='"+group_name+"']").eq(0).clone();r.find(".zombify_group[data-zombify-group-name='"+group_name+"']").eq(0).find(".zf-wysiwyg-advanced").each(function(){0===jQuery(this).parents(".zf-erase-before-save").length&&jQuery(this).froalaEditor(zf_wysiwyg_config_advanced)}),r.find(".zombify_group[data-zombify-group-name='"+group_name+"']").eq(0).find(".zf-wysiwyg-light").each(function(){0===jQuery(this).parents(".zf-erase-before-save").length&&jQuery(this).froalaEditor(zf_wysiwyg_config_light)}),r.find(".zombify_group[data-zombify-group-name='"+group_name+"']").eq(0).find(".zf-result-wysiwyg-light.active").each(function(){0===jQuery(this).parents(".zf-erase-before-save").length&&jQuery(this).froalaEditor(zf_wysiwyg_config_light)}),""!=e.attr("data-include-group")&&a.find(".zf-included-group").each(function(){jQuery(this).hasClass("zf-"+e.attr("data-include-group")+"_container")||jQuery(this).remove()}),a.find('input[type="file"]').attr("data-zf-file-browsed",0),a.find(".zf-image-preview-block").hide(),a.find(".zf-image-preview-block").removeClass("zf_remove_progress"),a.find(".zombify_clone").remove(),a.addClass("zombify_clone"),a.find(".zf-hidden").removeClass("zf-hidden"),a.find(":input[type!='checkbox'][type!='radio']").val(""),a.find(":input[type='radio'][data-zombify-erase-on-clone]").prop("checked",!1),a.find(".zombify_uploaded_image_item").remove(),a.find(".zf-embed-video").html(""),a.find(".zf-components").removeClass("zf-open"),a.find(".zombify_group_format").attr("data-group",e.data("type")),a.find("input[data-zombify-field-path='story/group_format']").val(e.data("type")),a.find(".zf-uploader").removeClass("zf-uploader-uploaded"),a.find(".zf-uploader").find(".zf-preview-img").attr("src","").hide(),a.find("[data-unique-id]").each(function(){randStr=ZombifyBuilder.randomString(32),jQuery(this).val(randStr)});var o=new RegExp("\\["+group_name+"\\]\\[\\d+\\]");a.find(":input").each(function(){this.name=this.name.replace(o,"["+group_name+"][10000]"),jQuery(this).attr("data-zombify-name-index","10000")}),1==e.attr("data-zombify-inside")?a.insertAfter(e.closest(".zombify_group")):"first"==e.attr("data-zombify-position")?a.prependTo(r.find(".zf-"+group_name+"_container")):a.appendTo(r.find(".zf-"+group_name+"_container")),a.find(".zf-wysiwyg-advanced").froalaEditor(zf_wysiwyg_config_advanced),a.find(".zf-wysiwyg-light").froalaEditor(zf_wysiwyg_config_light),a.find(".zf-result-wysiwyg-light.active").each(function(){jQuery(this).removeClass("active"),jQuery(this).froalaEditor("destroy"),jQuery(this).css({display:"block",height:"80px"}),jQuery(this).siblings(".fr-box.fr-basic").remove()}),a.find(".zf-video-upload").each(function(){jQuery(this).attr("data-zf-resumable","")}),a.find(".zf-help").remove(),a.parents(".zf-answers_container").find(".zombify_group").length>1?a.parents(".zf-answers_container").find(".zombify_group").each(function(){jQuery(this).find(".zombify_delete_group").removeClass("zf-hide-delete-icon")}):a.parents(".zf-results_container").find(".zombify_group").length>1?a.parents(".zf-results_container").find(".zombify_group").each(function(){jQuery(this).find(".zombify_delete_group").removeClass("zf-hide-delete-icon")}):a.parents(".zf-list_container").find(".zombify_group").length>1?a.parents(".zf-list_container").find(".zombify_group").each(function(){jQuery(this).find(".zombify_delete_group").removeClass("zf-hide-delete-icon")}):(a.find(".zf-answers_container").find(".zombify_group").find(".zombify_delete_group").addClass("zf-hide-delete-icon"),a.parents(".zf-questions_container").find(".zombify_delete_group").each(function(){0==jQuery(this).parents(".zf-answers_container").length&&jQuery(this).removeClass("zf-hide-delete-icon")}));var n=r.find(".zf-"+group_name+"_container").find(".zombify_group[data-zombify-group-name='"+group_name+"']");n.each(function(i){var r="["+group_name+"]["+i+"]";1!=e.attr("data-zf-not-arrange-group")&&jQuery(this).find(".zf-index").html(t?n.length-i:i+1),jQuery(this).find(":input").each(function(){this.name=this.name.replace(o,r);var e=jQuery(this).closest(".zombify_group").index();jQuery(this).attr("data-zombify-name-index",e),1==jQuery(this).attr("data-zf-use-index-as-value")&&jQuery(this).val(e)}),jQuery(this).find(".zombify_medatype_radio[checked]").prop("checked",!0)}),this.updateDependencies(!1),"1"==e.data("zf-without-focus")?(this.input_focus?a.find(".zf-inner-wrapper input[type=text]:first").focus():jQuery("input[data-zombify-field-path='title']").focus(),e.data("zf-without-focus","0"),this.input_focus=!0):e.data("type")?a.find(".zf-inner-wrapper[data-type="+e.data("type")+"] input:first").focus():a.find(".zf-inner-wrapper input[type=text]:first").focus()},this.randomString=function(e){for(var i="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;t<e;t++)i+=r.charAt(Math.floor(Math.random()*r.length));return i},this.deleteGroup=function(e){if(zombify_group=e.closest(".zombify_group"),group_name=zombify_group.attr("data-zombify-group-name"),zombify_group.parent().find(".zombify_group[data-zombify-group-name='"+group_name+"']").length>1||e.closest(".zf-"+group_name+"_container").hasClass("zf-must-delete")){zombify_group.removeClass("zombify_group");var i=new RegExp("\\["+group_name+"\\]\\[\\d+\\]");e.closest(".zf-"+group_name+"_container").find(".zombify_group[data-zombify-group-name='"+group_name+"']").each(function(e){var r="["+group_name+"]["+e+"]";jQuery(this).find(":input").each(function(){this.name=this.name.replace(i,r)})});var r=zombify_group.parents(".zf-"+group_name+"-container").data("reverse"),t=zombify_group.parent().find(".zombify_group[data-zombify-group-name='"+group_name+"']");t.each(function(a){var o="["+group_name+"]["+a+"]";1!=e.attr("data-zf-not-arrange-group")&&jQuery(this).find(".zf-index").html(r?t.length-a:a+1),jQuery(this).find(":input").each(function(){this.name=this.name.replace(i,o),jQuery(this).attr("data-zombify-name-index",a)})}),1==zombify_group.parent().find(".zombify_group[data-zombify-group-name='"+group_name+"']").length&&("answers"===group_name||"results"===group_name||"list"===group_name?zombify_group.parent().find(".zombify_group[data-zombify-group-name='"+group_name+"']").find(".zombify_delete_group").addClass("zf-hide-delete-icon"):"questions"===group_name&&zombify_group.parent().find(".zombify_group[data-zombify-group-name='"+group_name+"']").find(".zombify_delete_group").each(function(){0==jQuery(this).parents(".zf-answers_container").length&&jQuery(this).addClass("zf-hide-delete-icon")})),zombify_group.remove()}else{zombify_group.find(".zf-wysiwyg-advanced").each(function(){jQuery(this).froalaEditor("destroy")}),zombify_group.find(".zf-wysiwyg-light").each(function(){jQuery(this).froalaEditor("destroy")});var a=zombify_group.clone();a.find(".zombify_clone").remove(),a.removeClass("zombify_clone"),a.find(":input").val(""),a.appendTo(zombify_group.parent()),zombify_group.remove();var i=new RegExp("\\["+group_name+"\\]\\[\\d+\\]"),o="["+group_name+"][0]";a.find(":input").each(function(){this.name=this.name.replace(i,o)}),a.find(".zf-wysiwyg-advanced").froalaEditor(zf_wysiwyg_config_advanced),a.find(".zf-wysiwyg-light").froalaEditor(zf_wysiwyg_config_light)}this.updateDependencies(!1)},this.deleteMedia=function(e){e.parent().find("img").each(function(){jQuery(this).attr("src","").hide()}),e.parent().find(".zf-preview-gif-mp4").hide(),e.parent().find(".zf-preview-gif-mp4").find("source").attr("src",""),e.parent().find('input[type="file"]').val(""),e.parent().removeClass("zf-uploader-uploaded"),e.parent().find(".zf-video-player").hide(),e.parent().find(".zf-image_url").val(""),e.parent().find("input[data-zf-media-id]").val(""),e.parent().find("input[data-zf-media-id]").attr("data-zf-media-id","")},this.virtualSave=function(){if(this.saving_post||0==zombify_virtual_unsaved_form||0==jQuery(".zombify_quiz_type").length||"meme"==jQuery(".zombify_quiz_type").val())return!1;if(this.saving_post=!0,this.saving_virtual_post=!0,jQuery("#meme_settings").length>0){if(!createImageDataPressed())return this.saving_post=!1,0!==jQuery(".zf-meme").find(".zf-start").find(".zf-help").length&&jQuery(".zf-meme").find(".zf-start").find(".zf-help").remove(),jQuery(".zf-meme").find(".zf-start").append('<span class="zf-help">The field is required</span>'),!1;createImageDataPressed(),jQuery("#meme_settings").val(encodeObj(zombify_settings))}var e=jQuery(".zf-erase-before-save").html();if(jQuery(".zf-erase-before-save").html(""),isSafari11){var i=jQuery("#zombify-form"),r=jQuery('input[type="file"]:not([disabled])',i);r.each(function(e,i){i.files.length>0||jQuery(i).prop("disabled",!0)})}var t=new FormData(jQuery("#zombify-form")[0]);isSafari11&&r.prop("disabled",!1),jQuery(".zf-erase-before-save").html(e),t.append("action","zombify_virtual_save"),url_post_id=parseInt(jQuery(".zombify_post_id").val()),zombify_virtual_unsaved_form=!1;var a=zf.ajaxurl+"?action=virtual_save"+(url_post_id?"&post_id="+url_post_id:"");if("undefined"!=typeof zombify_virtual_addit_data){var o=jQuery.param(zombify_virtual_addit_data);""!=o&&(a+="&"+o),zombify_virtual_addit_data={}}var n=jQuery("input[data-zf-file-browsed='1']"),f=jQuery("input[data-zf-url-changed='1']");jQuery.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var i=e.loaded/e.total;i=parseInt(100*i),zombify_submit_process(i)}},!1),e},url:a,type:"POST",data:t,async:!0,dataType:"json",success:function(e){if(zombify_virtual_save_interval=zombify_virtual_save_interval_default,"undefined"!=typeof e.result)if(1==e.result){var i=function(e,i,r){return function(t,a){var o=jQuery(a).attr("name");if(!o)return!1;o=o.replace("file_url][",""),o=o.replace("[]",""),o=o.substr(8,o.length-9);var n=o.split("]["),f=e.data,s=!0;n=Object.keys(n).map(function(e){return n[e]});for(var d=0;d<n.length;d++){if("undefined"==typeof f[n[d]]){s=!1;break}f=f[n[d]]}if(s){var u=jQuery(a).attr("name");u=u.replace("[]",""),u=u.substr(7),u=u.replace("[file_url]",""),filedatahtml="",f=Object.keys(f).map(function(e){return f[e]});for(var p=0;p<f.length;p++)filedatahtml+='<div class="zombify_uploaded_image_item">',filedatahtml+='<input type="hidden" name="zombify_existing_data'+u+"["+p+'][attachment_id]" data-zf-media-id="'+f[p].attachment_id+'" value="'+f[p].attachment_id+'">',filedatahtml+='<input type="hidden" name="zombify_existing_data'+u+"["+p+'][existingfile]" value="1">',filedatahtml+="</div>";1==jQuery(a).closest(i).find(".zombify_uploaded_image_data").attr("zf-changed-uploaded-items")?jQuery(a).closest(i).find(".zombify_uploaded_image_data").append(filedatahtml):jQuery(a).closest(i).find(".zombify_uploaded_image_data").html(filedatahtml),jQuery(a).closest(i).find(".zombify_uploaded_image_data").attr("zf-changed-uploaded-items","1")}jQuery(a).val(""),jQuery(a).attr(r,"0")}};n.each(i(e,".zf-form-group","data-zf-file-browsed")),f.each(i(e,".zf-uploader","data-zf-url-changed")),jQuery(".zombify_uploaded_image_data").attr("zf-changed-uploaded-items","0")}else for(var r=0;r<e.errors.length;r++)"undefined"!=typeof e.errors[r].uploaded&&"undefined"!=typeof e.errors[r].uploaded.original&&jQuery(".zf-image_url").each(function(){jQuery(this).val()==e.errors[r].uploaded.original&&(jQuery(this).val(""),jQuery(this).closest(".zf-uploader").find(".zf-remove-media").closest(".zf-form-group").find(".zf-help").length>0?jQuery(this).closest(".zf-uploader").find(".zf-remove-media").closest(".zf-form-group").find(".zf-help").html(e.errors[r].error.errorMessage):jQuery(this).closest(".zf-uploader").find(".zf-remove-media").closest(".zf-form-group").append('<div class="zf-help">'+e.errors[r].error.errorMessage+"</div>"),ZombifyBuilder.deleteMedia(jQuery(this).closest(".zf-uploader").find(".zf-remove-media")),ZombifyBuilder.updateShowDependency(),jQuery(this).closest(".zf-uploader").find(".zf-remove-media").closest(".zf-form-group").find(".zombify_uploaded_image_item").remove())});ZombifyBuilder.saving_post=!1,ZombifyBuilder.saving_virtual_post=!1,ZombifyBuilder.trigger_post_save&&(ZombifyBuilder.trigger_post_save=!1,ZombifyBuilder.save(ZombifyBuilder.trigger_post_save_data.eButton,ZombifyBuilder.trigger_post_save_data.preview,ZombifyBuilder.trigger_post_save_data.publish)),n.each(function(){jQuery(this).closest(".zf-uploader").find(".zf_remove_progress").hide(),jQuery(this).closest(".zf-uploader").find(".zf_remove_progress").removeClass("zf_remove_progress")}),f.each(function(){jQuery(this).closest(".zf-uploader").find(".zf_remove_progress").hide(),jQuery(this).closest(".zf-uploader").find(".zf_remove_progress").removeClass("zf_remove_progress")})},error:function(e){toggleDisabledButton("remove"),ZombifyBuilder.saving_post=!1,ZombifyBuilder.saving_virtual_post=!1,ZombifyBuilder.trigger_post_save&&(ZombifyBuilder.trigger_post_save=!1,ZombifyBuilder.save(ZombifyBuilder.trigger_post_save_data.eButton,ZombifyBuilder.trigger_post_save_data.preview,ZombifyBuilder.trigger_post_save_data.publish)),n.each(function(){jQuery(this).closest(".zf-uploader").find(".zf_remove_progress").hide(),jQuery(this).closest(".zf-uploader").find(".zf_remove_progress").removeClass("zf_remove_progress")})},cache:!1,contentType:!1,processData:!1})},this.save=function(e,i,r){if(this.saving_post)return this.saving_virtual_post&&(e.addClass("zf-loading"),this.trigger_post_save=!0,this.trigger_post_save_data={eButton:e,preview:i,publish:r}),!1;if(this.saving_post=!0,"undefined"==typeof i&&(i=!1),"undefined"==typeof r&&(r=!1),jQuery(".zombify_save").parent().find(".zf-button-cont.zf-saved").remove(),e.addClass("zf-loading"),toggleDisabledButton("add"),jQuery("#meme_settings").length>0){if(!createImageDataPressed())return e.removeClass("zf-loading"),toggleDisabledButton("remove"),this.saving_post=!1,0!==jQuery(".zf-meme").find(".zf-start").find(".zf-help").length&&jQuery(".zf-meme").find(".zf-start").find(".zf-help").remove(),jQuery(".zf-meme").find(".zf-start").append('<span class="zf-help">The field is required</span>'),!1;createImageDataPressed(),jQuery("#meme_settings").val(encodeObj(zombify_settings))}if(jQuery(".zf-erase-before-save").remove(),isSafari11){var t=jQuery("#zombify-form"),a=jQuery('input[type="file"]:not([disabled])',t);a.each(function(e,i){i.files.length>0||jQuery(i).prop("disabled",!0)})}var o=new FormData(jQuery("#zombify-form")[0]);isSafari11&&a.prop("disabled",!1),o.append("action","zombify_save"),r&&o.append("zombify_publish_post","1"),url_post_id=parseInt(e.closest("form").find(".zombify_post_id").val()),jQuery.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var i=e.loaded/e.total;i=parseInt(100*i),zombify_submit_process(100==i?zf.translatable.processing_files:zf.translatable.uploading_files+": "+i+"%")}},!1),e},url:zf.ajaxurl+"?action=save"+(url_post_id?"&post_id="+url_post_id:""),type:"POST",data:o,async:!0,dataType:"json",success:function(i){e.removeClass("zf-loading"),toggleDisabledButton("remove"),"undefined"!=typeof i.result?((0==i.result||1==i.result&&!r)&&jQuery(".zombify_quiz").replaceWith(i.output),jQuery(".zf-result-wysiwyg-light.active").froalaEditor(zf_wysiwyg_config_light),zf_video_upload_func(),zfContainerWidth(),jQuery("#tag-editor").length&&(jQuery("#tag-editor").tagEditor("destroy"),jQuery("#tag-editor").tagEditor({placeholder:jQuery("#tag-editor").attr("placeholder"),maxTags:jQuery("#tag-editor").attr("data-count-limit"),autocomplete:{delay:0,position:{collision:"flip"},source:zf.ajaxurl+"?action=zombify_get_tags"},forceLowercase:!1})),jQuery(".zf-wysiwyg-advanced").each(function(){0===jQuery(this).parents(".zf-erase-before-save").length&&jQuery(this).froalaEditor(zf_wysiwyg_config_advanced)}),jQuery(".zf-wysiwyg-light").each(function(){0===jQuery(this).parents(".zf-erase-before-save").length&&jQuery(this).froalaEditor(zf_wysiwyg_config_light)}),1==i.result?(jQuery(".zf-button-cont.zf-draft").hide(),zombify_unsaved_form=!1,jQuery(".zf-errors-btn").hide(),r?window.location=i.post_url:(jQuery(".zombify_preview").attr("href",i.post_url).removeClass("zf-disabled"),ZombifyBuilder.saving_post=!1,0==jQuery(".zombify_save").parent().find(".zf-button-cont.zf-saved").length&&jQuery(".zombify_save").after('<div class="zf-float-left zf-button-cont zf-saved"><i class="zf-icon zf-icon-check"></i>'+zf.translatable.saved+"</div>")),""!==jQuery(".meme-template").val()&&jQuery("#zf-meme-img").attr("src",jQuery(".meme-template").val()),initMeme(jQuery),e.closest("form").find(".zombify_post_id").val(i.post_id)):(jQuery(".zf-error").length>0&&(jQuery(".zf-error").find(".zf-uploader-uploaded").removeClass("zf-uploader-uploaded"),jQuery(".zf-errors-btn").find(".zf-custom-error").remove(),jQuery(".zf-errors-btn").find(".zf-errors-count").show(),jQuery(".zf-errors-btn").show(),jQuery(".zf-errors-btn").find(".zf-errors-count").html(jQuery(".zf-error").length),1===jQuery(".zf-error").length?(jQuery(".zf-errors-btn").find(".zf-single-error-case").show(),jQuery(".zf-errors-btn").find(".zf-many-errors-case").hide()):(jQuery(".zf-errors-btn").find(".zf-single-error-case").hide(),jQuery(".zf-errors-btn").find(".zf-many-errors-case").show())),""!==jQuery(".meme-template").val()&&jQuery("#zf-meme-img").attr("src",jQuery(".meme-template").val()),initMeme(jQuery),jQuery("#zombify-main-section .zf-error:first")[0].scrollIntoView(!0),ZombifyBuilder.saving_post=!1),ZombifyBuilder.correctBuilder(),ZombifyBuilder.updateShowDependency(),ZombifyBuilder.updateDependencies(!0),jQuery(".zf-multiple-select").zombifyMultiSelect()):ZombifyBuilder.saving_post=!1,jQuery(".zf_remove_progress").hide(),jQuery(".zf_remove_progress").removeClass("zf_remove_progress")},error:function(i){if(console.log("error"),IsJsonString(i.responseText)){var r=jQuery.parseJSON(i.responseText);r&&"undefined"!=typeof r.message&&""!=r.message?errorMessage=r.message:errorMessage=zf.translatable.unknown_error}else errorMessage=zf.translatable.unknown_error;0==jQuery(".zf-errors-btn").find(".zf-custom-error").length?jQuery(".zf-errors-btn").append('<span class="zf-custom-error">'+errorMessage+"</span>"):jQuery(".zf-errors-btn").find(".zf-custom-error").html(errorMessage),jQuery(".zf-errors-btn").find(".zf-custom-error").show(),jQuery(".zf-errors-btn").find(".zf-single-error-case").hide(),jQuery(".zf-errors-btn").find(".zf-many-errors-case").hide(),jQuery(".zf-errors-btn").find(".zf-errors-count").hide(),jQuery(".zf-errors-btn").show(),ZombifyBuilder.saving_post=!1,e.removeClass("zf-loading"),toggleDisabledButton("remove"),jQuery(".zf-image-preview-block").hide()},cache:!1,contentType:!1,processData:!1})},this.sort=function(e,i){switch(i){case"down":var r=e.next();e.insertAfter(r);break;case"up":var r=e.prev();e.insertBefore(r);break;default:return console.log("Incorrect direction"),!1}if(e[0].scrollIntoView(!0),e.parent().closest(".zombify_group").length>0)var t=e.parent().closest(".zombify_group");else var t=e.parent().closest(".zombify_quiz");var a=t.find(".zf-"+e.attr("data-zombify-group-name")+"-container").data("reverse"),o=(new RegExp("\\["+e.attr("data-zombify-group-name")+"\\]\\[\\d+\\]"),t.find(".zf-"+e.attr("data-zombify-group-name")+"_container").find(".zombify_group[data-zombify-group-name='"+e.attr("data-zombify-group-name")+"']"));o.each(function(e){jQuery(this).find(".zf-index").html(a?o.length-e:e+1)}),this.updateDependencies(!1)},this.changeMediaType=function(e){jQuery(e).prop("checked",!0);var i=jQuery(e).val();switch(i){case"embed":e.closest(".zf-form-group").find(".zombify_medatype_image").find(":input").prop("disabled",!0),e.closest(".zf-form-group").find(".zombify_medatype_embed").find(":input").prop("disabled",!1);break;case"image":e.closest(".zf-form-group").find(".zombify_medatype_image").find(":input").prop("disabled",!1),e.closest(".zf-form-group").find(".zombify_medatype_embed").find(":input").prop("disabled",!0);break;default:console.log("Unknown media type")}},this.correctBuilder=function(){if(jQuery('textarea[name="zombify[preface_description]"]').length>0){var e=jQuery('textarea[name="zombify[preface_description]"]').val();jQuery('textarea[name="zombify[preface_description]"]').val(e)}jQuery(".zf-form-group_media").each(function(){var e=jQuery(this).find(".zombify_medatype_radio:checked").val();jQuery(this).find(".zf-media-uploader").attr("data-format",e)}),jQuery(".js-zf-answer-format input:checked").each(function(){var e=jQuery(this).data("format");jQuery(this).parent().parent().siblings(".zf-answers-box").attr("data-format",e)})},this.updateDependencies=function(e){jQuery("select[data-zombify-dependency]").each(function(){var i=jQuery(this),r=e?i.attr("data-zf-seled-val"):i.val(),t=i.attr("data-zombify-dependency");i.find("option[value!='']").remove(),jQuery(":input[data-zombify-field-path='"+t+"']").each(function(){jQuery(this).val()&&i.append('<option value="'+jQuery(this).attr("data-zombify-name-index")+'" '+(jQuery(this).attr("data-zombify-name-index")==r?"selected":"")+">"+jQuery(this).val()+"</option>")})}),this.updateShowDependency()},this.updateShowDependency=function(){jQuery("input[data-zombify-show-dependency]").each(function(){var e=jQuery(this).closest(".zombify_group").length>0?jQuery(this).closest(".zombify_group"):jQuery(this).closest(".zf-main").length>0?jQuery(this).closest(".zf-main"):jQuery(this).closest(".zombify-main-section"),i=jQuery(this).attr("data-zombify-show-dependency"),r=i.split(","),t=0;for(ii=0;ii<r.length;ii++)"file"==e.find("input[data-zombify-field-path='"+r[ii]+"']").attr("type")&&""==e.find("input[data-zombify-field-path='"+r[ii]+"']").val()&&0==e.find("input[data-zombify-field-path='"+r[ii]+"']").closest(".zf-uploader").find(".zombify_uploaded_image_data").find(".zombify_uploaded_image_item").length||"checkbox"==e.find("input[data-zombify-field-path='"+r[ii]+"']").attr("type")&&0==e.find("input[data-zombify-field-path='"+r[ii]+"']").prop("checked")||e.find("input[data-zombify-field-path='"+r[ii]+"']").length>0&&"url"==e.find("input[data-zombify-field-path='"+r[ii]+"']").attr("type")&&""==e.find("input[data-zombify-field-path='"+r[ii]+"']").val()||e.find("input[data-zombify-field-path='"+r[ii]+"']").length>0&&"text"==e.find("input[data-zombify-field-path='"+r[ii]+"']").attr("type")&&""==e.find("input[data-zombify-field-path='"+r[ii]+"']").val()||e.find("input[data-zombify-field-path='"+r[ii]+"']").length>0&&"hidden"==e.find("input[data-zombify-field-path='"+r[ii]+"']").attr("type")&&""==e.find("input[data-zombify-field-path='"+r[ii]+"']").val()||e.find("textarea[data-zombify-field-path='"+r[ii]+"']").length>0&&""==e.find("textarea[data-zombify-field-path='"+r[ii]+"']").val()||(t=1);0==t?(jQuery(this).css("visibility","hidden"),"text"==jQuery(this).attr("type")&&jQuery(this).val(""),"checkbox"==jQuery(this).attr("type")&&jQuery(this).prop("checked",!1),jQuery(this).parent().hasClass("zf-form-group")&&jQuery(this).parent().hide(),jQuery(this).parent().parent().hasClass("zf-form-group")&&jQuery(this).parent().parent().hide(),jQuery(this).parent().parent().parent().hasClass("zf-form-group")&&!jQuery(this).parent().parent().parent().hasClass("zf-dependency-show")&&jQuery(this).parent().parent().parent().hide()):(jQuery(this).css("visibility","visible"),jQuery(this).parent().hasClass("zf-form-group")&&jQuery(this).parent().show(),jQuery(this).parent().parent().hasClass("zf-form-group")&&jQuery(this).parent().parent().show(),jQuery(this).parent().parent().parent().hasClass("zf-form-group")&&!jQuery(this).parent().parent().parent().hasClass("zf-dependency-show")&&jQuery(this).parent().parent().parent().show())})},this.validateFields=function(){jQuery(".zombify_quiz input[type='file']").each(function(){ZombifyBuilder.validateField(jQuery(this))})},this.validateField=function(e){var r=new Array;if(jQuery(e).attr("zf-validation-extensions")){errMsg=zf.translatable.invalid_file_extension+" "+jQuery(e).attr("zf-validation-extensions");var t=jQuery(e).attr("zf-validation-extensions"),a=t.split(",");for(j=0;j<a.length;j++)a[j]=a[j].trim();for(filesList=jQuery(e)[0].files,i=0;i<filesList.length;i++){var o=filesList[i].name.substr(filesList[i].name.lastIndexOf(".")+1);o=o.toLowerCase(),ZombifyBuilder.inArray(o,a)||(r[r.length]=errMsg)}}if(jQuery(e).attr("zf-validation-maxSize")){errMsg=zf.translatable.invalid_file_size+" "+Math.round(parseInt(jQuery(e).attr("zf-validation-maxSize"))/1024)+"MB";var n=1024*parseInt(jQuery(e).attr("zf-validation-maxSize"));for(filesList=jQuery(e)[0].files,i=0;i<filesList.length;i++)filesList[i].size>n&&(r[r.length]=errMsg)}return r.length>0?(jQuery(e).closest(".zf-form-group").find(".zf-help").length>0?jQuery(e).closest(".zf-form-group").find(".zf-help").html(r.join("<br>")):jQuery(e).closest(".zf-form-group").append('<div class="zf-help">'+r.join("<br>")+"</div>"),!1):(jQuery(e).closest(".zf-form-group").find(".zf-help").remove(),!0)},this.deleteMediaAttachment=function(e){toggleDisabledButton("add"),jQuery.ajax({url:zf.ajaxurl+"?action=zombify_delete_media",type:"POST",data:{attach_id:e,action:"zombify_delete_media"},dataType:"json",success:function(e){toggleDisabledButton("remove")}})},this.inArray=function(e,i){for(var r=i.length,t=0;t<r;t++)if(i[t]==e)return!0;return!1}};